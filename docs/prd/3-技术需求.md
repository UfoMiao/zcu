# 3. 技术需求

## 3.1 架构设计

### 3.1.1 存储架构
```typescript
// 核心存储架构
LevelDB + Shadow Repository + 内存缓存
├── LevelDB: 轻量KV存储(~200KB)，存储元数据和会话信息
├── Shadow Repository: Git仓库管理文件快照，支持增量存储
└── 内存缓存: 提升读写性能，缓存热点数据
```

**技术要求**:
- LevelDB版本≥6.0.0
- Node.js版本≥16.0.0
- Git版本≥2.30.0
- 跨平台支持(Windows/Mac/Linux)

### 3.1.2 UI架构
```typescript
// React共享组件架构
ZCU Core API Server
├── React共享组件库 (通用UI逻辑)
├── Ink终端UI (React Ink渲染)
├── Web Dashboard (React Web渲染)
└── ZCF命令集成 (白话操作支持)
```

**技术要求**:
- React版本≥18.0.0
- Ink版本≥4.0.0
- TypeScript版本≥5.0.0
- 打包工具: unbuild

### 3.1.3 会话管理
```typescript
// AI工作空间隔离设计
interface AIWorkspace {
  sessionId: string;           // claude_workspace_uuid
  aiAgent: string;            // 区分不同Claude实例
  projectPath: string;        // 项目路径
  workspaceState: WorkspaceState; // active|paused|conflict
  operationChain: Operation[]; // 操作链追踪
  conflictDetection: ConflictManager; // 冲突检测机制
}
```

## 3.2 性能要求

### 3.2.1 基础性能指标
- **启动时间**: ≤2秒
- **快照创建**: ≤3秒(100MB项目)
- **内存占用**: ≤50MB(基础模式)
- **磁盘占用**: ≤200KB(LevelDB) + 动态快照大小
- **CPU使用率**: ≤10%(待机状态)

### 3.2.2 并发性能指标
- **并发AI实例**: ≥3个(MVP), ≥10个(完整版)
- **并发用户**: ≥10人(Web Dashboard)
- **数据库连接**: ≤50个(LevelDB连接池)
- **响应时间**: ≤500ms(UI操作), ≤1秒(复杂查询)

### 3.2.3 可靠性指标
- **可用性**: ≥99.9%
- **数据完整性**: =100%
- **崩溃恢复**: ≤10秒
- **备份成功率**: ≥99.99%

## 3.3 安全要求

### 3.3.1 数据安全
- 本地存储加密(AES-256)
- 敏感信息脱敏处理
- 访问权限控制
- 定期安全审计

### 3.3.2 操作安全
- 操作权限验证
- 危险操作二次确认
- 审计日志不可篡改
- 回滚操作安全评估

---
